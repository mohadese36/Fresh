<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>categori</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="vendor/BootStrap/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/SwiperSlider/swiper.css">
    <link rel="stylesheet" href="vendor/FontAwesome5/all.min.css" />
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css">
    <style>
      
    </style>
</head>
<body>
    <!-- Start Header -->
    <header class="header">
        <div class="top-bar">
            <div class="container-fluid">
                <div class="top-bar__content">
                    <div class="top-bar__right"></div>
                    <div class="top-bar__left">
                        <a href="#" class="main-header__search-bt">
                            <i class="fas fa-search main-header__search-icon"></i>
                        </a>
                        <a href="./cart.html" class="main-header__cart-btn position-relative">
                          <i class="fas fa-shopping-cart main-header__cart-icon"></i>
                          <span id="cart-count-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display:none;">0</span>
                        </a>
                        <a href="#" class="main-header__profile">
                            <span class="main-header__profile-text">محمد امین سعیدی راد</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
      <div class="main-header">
        <div>
          <div class="main-header__content">
            <ul id="navbar" class="main-header__menu"></ul>
        </div>
        </div>
      </div>
    </header>
    <!-- Finish Header -->



    <!-- Start product Main Info -->
    <!-- <section class="product-info">
        <div class="container">
            <div class="row">
            <div class="col-6">
                <a href="#" class="product-info__link">
                آموزش برنامه نویسی فرانت اند
                </a>
                <h1 class="product-info__title">
                آموزش 20 کتابخانه جاوااسکریپت برای بازار کار
                </h1>
                <p class="product-info__text">
                امروزه کتابخانه‌ها کد نویسی را خیلی آسان و لذت بخش تر کرده اند. به قدری که حتی امروزه هیچ شرکت برنامه نویسی پروژه های خود را با Vanilla Js پیاده سازی نمی کند و همیشه از کتابخانه ها و فریمورک های موجود استفاده می کند. پس شما هم اگه میخواید یک برنامه نویس عالی فرانت اند باشید، باید کتابخانه های کاربردی که در بازار کار استفاده می شوند را به خوبی بلد باشید
                </p>
                <div class="product-info__social-media">
                <a href="#" class="product-info__social-media-item">
                    <i class="fab fa-telegram-plane product-info__icon"></i>
                </a>
                <a href="#" class="product-info__social-media-item">
                    <i class="fab fa-twitter product-info__icon"></i>
                </a>
                <a href="#" class="product-info__social-media-item">
                    <i class="fab fa-facebook-f product-info__icon"></i>
                </a>
                </div>
            </div>
    
            <div class="col-6">
                <img src="images/products/js_project.png" class="product-info__img" controls></img>
            </div>
            </div>
        </div>
    </section> -->
    <!-- Finish product Main Info -->

    <!-- Start Main Info Section -->
    <main class="main">
        <div class="container">
          <div class="products-wrapper">
            <div>
                <aside>
                    <form method="get" action="/search/">
                        <div class="form-group mb-3">
                            <div class="input-group">
                                <input class="form-control border-secondary" type="search" name="q" placeholder="search products..." aria-label="search products...">
                                <button class="btn btn-secondary" type="submit" aria-label="Start search"><i class="bi bi-search"></i></button>
                            </div>
                        </div>
                    </form>
                    <div class="card card-cats-menu">
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><a class="d-block" href="/offers/">Special Offers</a></li>
                                
                                <li class="list-group-item"><a class="d-block" href="/c/Charcuterie/">Charcuterie</a></li><li class="list-group-item"><a class="d-block" href="/c/Hams/">Hams</a></li><li class="list-group-item"><a class="d-block" href="/c/Sausage/">Sausages</a></li><li class="list-group-item"><a class="d-block" href="/c/Bacon/">Bacon</a></li><li class="list-group-item"><a class="d-block" href="/c/BlackPudding/">Black Pudding</a></li><li class="list-group-item"><a class="d-block" href="/c/Beef/">Fresh Beef</a></li><li class="list-group-item"><a class="d-block" href="/c/Pork/">Fresh Pork</a></li><li class="list-group-item"><a class="d-block" href="/c/Vouchers/">Gift Vouchers</a></li>
                            </ul>
                        </div>
                    </div>
                </aside>
                <!-- <div class="products-info">
                  <div class="product-info">
                    <div class="product-info__register">
                      <span class="product-info__register-title">
                        <i class="fas fa-graduation-cap product-info__register-icon"></i>
                        دانشجوی دوره هستید
                      </span>
                    </div>
                  </div>
    
                  <div class="product-info"></div>
                  <div class="product-info"></div>
                  <div class="product-info"></div>
                  <div class="product-info"></div>
                </div> -->
            </div>

            <div>
              <div class="product">
                <!-- Start Breadcrumb -->
                <section class="breadcrumb">
                    <div class="container">
                        <div class="breadcrumb__content">
                        <div class="breadcrumb__home-content-icon">
                            <i class="fas fa-home breadcrumb__home-icon"></i>
                        </div>
                        <ul class="breadcrumb__list">
                            <li class="breadcrumb__item">
                            <a href="#" class="breadcrumb__link">
                                خانه
                                <i class="fas fa-angle-left breadcrumb__icon"></i>
                            </a>
                            </li>
                            <li class="breadcrumb__item">
                            <a href="#" class="breadcrumb__link">
                                آموزش برنامه نویسی فرانت اند
                                <i class="fas fa-angle-left breadcrumb__icon"></i>
                            </a>
                            </li>
                            <li class="breadcrumb__item">
                            <a href="#" class="breadcrumb__link">
                                دوره متخصص جاوا اسکریپت
                            </a>
                            </li>
                        </ul>
                        </div>
                    </div>
                </section>     
                <h1 id="category-title"></h1>
                <div id="products-container" class="row"></div>
                <div id="product-features" class="product-features"></div>
                <div id="test-products-container"></div>
            </div>
          </div>

          <div>
            <aside>
              <div id="basket-box-container"></div>
            </aside>
          </div>


        </div>


    </main>
    <!-- Finish Main Info Section -->

    <!-- Start Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-widgets">
            <div class="row">
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    درباره ما
                    </span>
                    <p class="footer-widgets__text">
                    وقتی تازه شروع به یادگیری برنامه نویسی کردم. یکی از مشکلاتی که در فرآیند یادگیری داشتم، کمبود آموزش های خوب با پشتیبانی قابل قبول بود که باعث شد اون موقع تصمیم بگیرم اگر روزی توانایی مالی و فنی قابل قبولی داشتم یک وب سایت برای حل این مشکل راه اندازی کنم! و خب امروز آکادمی آموزش برنامه نویسی سبزلرن به عنوان یک آکادمی خصوصی فعالیت میکنه و این به این معنی هست که هر مدرسی اجازه تدریس در اون رو نداره و باید از فیلترینگ های خاص آکادمی سبزلرن رد شه! این به این معنی هست که ما برامون فن بیان و نحوه تعامل مدرس با دانشجو بسیار مهمه! ما در آکادمی سبزلرن تضمین پشتیبانی خوب و با کیفیت رو به شما میدیم . چرا که مدرسین وب سایت سبزلرن حتی برای پشتیبانی دوره های رایگان شون هم هزینه دریافت میکنند و متعهد هستند که هوای کاربر های عزیز رو داشته باشند !
                    </p>
                </div>
                </div>
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    آخرین مطالب
                    </span>
                    <div class="footer-widgets__links">
                    <a href="#" class="footer-widgets__link">
                        نحوه نصب کتابخانه در پایتون | آموزش نصب کتابخانه پایتون
                    </a>
                    <a href="#" class="footer-widgets__link">
                        چگونه پایتون را آپدیت کنیم؟ | آموزش صفر تا صد آپدیت کردن پایتون      
                    </a>
                    <a href="#" class="footer-widgets__link">
                        آموزش نصب پایتون ( Python ) در در مک، ویندوز و لینوکس | گام به گام و تصویری
                    </a>
                    <a href="#" class="footer-widgets__link">
                        بهترین فریم ورک های فرانت اند | 16 فریم ورک Front end بررسی معایب و مزایا
                    </a>
                    <a href="#" class="footer-widgets__link">
                        معرفی بهترین سایت آموزش جاوا اسکریپت [ تجربه محور ] + آموزش رایگان
                    </a>
                    </div>
                </div>
                </div>
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    دسترسی سریع
                    </span>
                    <div class="row">
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش HTML
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش CSS
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش جاوا اسکریپت
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش بوت استرپ
                            </a>
                        </div>
                        <div class="col-6">       
                        <a href="#" class="footer-widgets__link">
                            آموزش ریکت
                        </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش پایتون
                            </a>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div> 
        <div class="footer__copyright">
            <span class="footer__copyright-text">
                کلیه حقوق برای آکادمی آموزش برنامه نویسی سبز لرن محفوظ است.
            </span>
        </div>
    </footer>
    <!-- Finish Footer -->
    
<script src="vendor/fontAwesome5/all.min.js"></script>
<script src="vendor/Bootstrap/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script type="module" src="./js/index.js"></script>
<script type="module" src="./js/menu.js"></script>
<script type="module" src="./js/categori.js"></script>
<script type="module" src="./js/basket-box.js"></script>




<!-- <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script> -->
<!-- <script type="module" src="js/index.js"></script> -->
 <!-- <script type="module" src="./js/categori.js"></script> -->



<script>
  document.addEventListener('DOMContentLoaded', () => {
    const params = new URLSearchParams(window.location.search);
    console.log('All URL params:', [...params.entries()]);
  });
</script>







<!-- <script>
    const SUPABASE_URL = 'https://lgbgwpbpxtmltzrsbjnx.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxnYmd3cGJweHRtbHR6cnNiam54Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2NzUxNzQsImV4cCI6MjA2ODI1MTE3NH0.Em8mM1z9xvVVKSi5kDfSoq-_Qof-u5JM7hDdqec6XA0';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  
    // منو
    // اجرای اصلی بعد از بارگذاری
    document.addEventListener('DOMContentLoaded', fetchMenus);
  
    async function fetchMenus() {
      const { data: menus, error } = await supabase
        .from('menus')
        .select('*')
        .order('id', { ascending: true });
  
      if (error) {
        console.error('Error fetching menus:', error);
        return;
      }
  
      const menuTree = buildMenuTree(menus);
      const html = buildMenuHTML(menuTree);
      document.getElementById('navbar').innerHTML = html;
    }
  
    // تبدیل لیست به درخت منو
    function buildMenuTree(items, parentId = null) {
      return items
        .filter(item => item.parent_id === parentId)
        .map(item => ({
          ...item,
          children: buildMenuTree(items, item.id)
        }));
    }
  
    // تولید HTML از ساختار درختی
    function buildMenuHTML(tree) {
      let html = '';
      tree.forEach(item => {
        const hasChildren = item.children.length > 0;
        html += `
          <li class="main-header__item">
            ${item.url ? `<a href="${item.url}">${item.title}</a>` : `<span>${item.title}</span>`}
            ${hasChildren ? `<ul class="main-header__dropdown">${buildMenuHTML(item.children)}</ul>` : ''}
          </li>
        `;
      });
      return html;
    }
//////////////////////////////////////////////////////////////
// بارگزاری صفحه ارشیو


document.addEventListener('DOMContentLoaded', () => {
    fetchMenus(); // از قبل هست
    fetchProducts(); // این برای محصولات
  });

  async function fetchProducts() {
    const { data, error } = await supabase
    .from('products')
    .select(`
        id,
        name,
        description,
        price,
        stock,
        created_at,
        updated_at,
        category_id,
        image_url,
        category:category_id (
        id,
        name
        )
    `)
    .order('category_id', { ascending: true })  // مرتب سازی بر اساس دسته
    .order('id', { ascending: true });          // مرتب سازی محصولات داخل هر دسته بر اساس id



    if (error) {
      console.error('Error fetching products:', error);
      return;
    }

    renderProducts(data);
  }

//   function renderProducts(products) {
//     const container = document.getElementById('products-container');
//     container.innerHTML = '';

//     const grouped = {};

//     products.forEach(product => {
//       const cat = product.category.name;
//       if (!grouped[cat]) grouped[cat] = [];
//       grouped[cat].push(product);
//     });

//     for (const categoryName in grouped) {
//       const section = document.createElement('div');
//       section.classList.add('product-boxes');

//       section.innerHTML = `
//         <h2 class="product-category">${categoryName}</h2>
//         <div class="row">
//           ${grouped[categoryName].map(prod => `
//             <div class="col-3">
//               <div class="product-boxes__box">
//                 <a href="#">
//                   <img src="images/products/placeholder.jpg" alt="${prod.name}" class="img-fluid improduct-box__img-main">
//                 </a>
//                 <div class="product-box__main">
//                   <div class="col-7 ps-2 product-box__detiles">
//                     <a class="product-box__detiles-title">${prod.name}</a>
//                     <p class="product-box__detiles-info">${prod.description}</p>
//                     <p class="product-box__detiles-info">£${parseFloat(prod.price).toFixed(2)}/kg</p>
//                   </div>
//                 </div>
//                 <div class="product-box__footer"></div>
//               </div>
//             </div>
//           `).join('')}
//         </div>
//       `;

//       container.appendChild(section);
//     }
//   }


//////////نشان دادن صفحه آرشیو


function renderProducts(products) {
  const container = document.getElementById('products-container');
  container.innerHTML = '';

  const grouped = {};

  products.forEach(product => {
    const cat = product.category.name;
    if (!grouped[cat]) grouped[cat] = [];
    grouped[cat].push(product);
  });

  for (const categoryName in grouped) {
    const section = document.createElement('div');
    section.classList.add('product-boxes');

    section.innerHTML = `
      <h2 class="product-category">${categoryName}</h2>
      <div class="row">
        ${grouped[categoryName].map(prod => `
          <div class="col-3">
            <div class="product-boxes__box">
              <a href="#">
                <img src="${prod.image_url || 'images/products/placeholder.jpg'}" alt="${prod.name}" class="img-fluid improduct-box__img-main">
              </a>
              <div class="product-box__main">
                <div class="col-7 ps-2 product-box__detiles">
                  <a class="product-box__detiles-title">${prod.name}</a>
                  <p class="product-box__detiles-info">${prod.description}</p>
                  <p class="product-box__detiles-info">£${parseFloat(prod.price).toFixed(2)}/kg</p>
                </div>
              </div>
              <div class="product-box__footer"></div>
            </div>
          </div>
        `).join('')}
      </div>
    `;

    container.appendChild(section);
  }
}

//////////////////بارگزاری صفحه هر دسته 

// گرفتن slug از URL
const params = new URLSearchParams(window.location.search);
const categorySlug = params.get("slug");

if (!categorySlug) {
  document.getElementById("products-container").innerHTML = "<p>Please select a category.</p>";
} else {
  loadProductsByCategory(categorySlug);
}

async function loadProductsByCategory(slug) {
  const { data: category, error: catErr } = await supabase
    .from('categories')
    .select('id, name')
    .eq('slug', slug)
    .single();

  if (catErr || !category) {
    document.getElementById("products-container").innerHTML = "<p>Category not found.</p>";
    return;
  }

  // نمایش عنوان دسته
  document.getElementById("category-title").textContent = category.name;

  const { data: products, error: prodErr } = await supabase
    .from('products')
    .select('*')
    .eq('category_id', category.id);

  if (prodErr || !products) {
    document.getElementById("products-container").innerHTML = "<p>Error loading products.</p>";
    return;
  }

  const container = document.getElementById("products-container");
  container.innerHTML = ''; // پاک کردن محتوا قبل از نمایش محصولات

products.forEach(p => {
  const col = document.createElement("div");
  col.className = "col-3";

  const box = document.createElement("div");
  box.className = "product-boxes__box";

  box.innerHTML = `
    <a href="#">
      <img src="${p.image_url || 'https://via.placeholder.com/150'}"
           alt="${p.name}"
           class="img-fluid improduct-box__img-main" />
    </a>
    <div class="product-box__main">
      <div class="col-7 ps-2 product-box__detiles">
        <a class="product-box__detiles-title">${p.name}</a>
        <p class="product-box__detiles-info">${p.description || ''}</p>
        <p class="product-box__detiles-info">£${p.price}/kg</p>
        <span class="product-box__detiles-price">Guide price: £${(p.price * 0.45).toFixed(2)}</span>
      </div>
    </div>
    <div class="product-box__footer"></div>
  `;

  col.appendChild(box);
  container.appendChild(col);
});

}





</script> -->




<!-- <script>
  fetch('basket-box.html')
    .then(res => res.text())
    .then(data => {
      document.getElementById('basket-box-container').innerHTML = data;
    });
</script> -->


</body>
</html>