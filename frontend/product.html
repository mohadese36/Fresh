<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>product</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="vendor/BootStrap/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/SwiperSlider/swiper.css">
    <link rel="stylesheet" href="vendor/FontAwesome5/all.min.css" />
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/product.css">
</head>
<body>
    <!-- Start Header -->
    <header class="header">
        <div class="top-bar">
            <div class="container-fluid">
                <div class="top-bar__content">
                    <div class="top-bar__right"></div>
                    <div class="top-bar__left">
                        <a href="#" class="main-header__search-bt">
                            <i class="fas fa-search main-header__search-icon"></i>
                        </a>
                        <a href="#" class="main-header__cart-btn">
                            <i class="fas fa-shopping-cart main-header__cart-icon"></i>
                        </a>
                        <a href="#" class="main-header__profile">
                            <span class="main-header__profile-text">محمد امین سعیدی راد</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="main-header">
            <div>
                <div class="main-header__content">
                    <ul id="navbar" class="main-header__menu"></ul>

                    <!-- <ul class="main-header__menu" id="navbar">   
                        <li class="main-header__item"><span>Regions & Home</span>
                            <ul class="main-header__dropdown">
                                <li><a href="#special-offers"><span>Special Offers</span></a></li>
                                <li><a href="#new-arrivals"><span>New Arrivals</span></a></li>
                                <li><a href="#best-sellers"><span>Best Sellers</span></a></li>
                                <li><a href="#discounted-products"><span>Discounted Products</span></a></li>
                                <li><a href="#customer-reviews"><span>Customer Reviews</span></a></li>
                                <li><a href="#contact-us"><span>Contact Us</span></a></li>
                            </ul>
                        </li>
                        <li class="main-header__item"><span>Products</span>
                            <ul class="main-header__dropdown">
                                <li><span>Sausage</span>
                                    <ul>
                                        <li>Red Meat Sausage</li>
                                        <li>Chicken Sausage</li>
                                        <li>Hot Dog</li>
                                        <li>Smoked Sausage</li>
                                        <li>Chorizo Sausage</li>
                                        <li>Pepperoni Sausage</li>
                                    </ul>
                                </li>
                                <li><span>Sausage</span>
                                    <ul>
                                        <li>Red Meat Sausage</li>
                                        <li>Chicken Sausage</li>
                                        <li>Hot Dog</li>
                                        <li>Smoked Sausage</li>
                                        <li>Chorizo Sausage</li>
                                        <li>Pepperoni Sausage</li>
                                    </ul>
                                </li>
                                <li><span>Salami</span>
                                    <ul>
                                        <li>Beef Salami</li>
                                        <li>Chicken & Mushroom Salam</li>
                                        <li>Special Ham</li>
                                        <li>Dry Salami</li>
                                        <li>Special Salami</li>
                                    </ul>
                                </li>
                                <li><span>Burger</span>
                                    <ul>
                                        <li>Beef Burger</li>
                                        <li>Chicken Burger</li>
                                        <li>Turkey Burger</li>
                                        <li>Vegan Burger</li>
                                    </ul>
                                </li>
                                <li><span>Diet Products</span>
                                    <ul>
                                        <li>Low Fat Sausage</li>
                                        <li>Low Fat Salami</li>
                                        <li>Protein Burger</li>
                                        <li>Gluten Free Products</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="main-header__item"><span>Article</span></li>
                        <li class="main-header__item"><span>Featured Products</span>
                            <ul class="main-header__dropdown">
                                <li><span>Organic & Healthy Products</span></li>
                                <li><span>Top Products for Specific Categories</span></li>
                                <li><span>Exclusive Store Products</span></li>
                                <li><span>Products with Unique Features</span></li>
                            </ul>
                        </li>
                        <li class="main-header__item"><span>Join Our Community</span>
                            <ul class="main-header__dropdown">
                                <li><span>login</span></li>
                                <li><span>rejister</span></li>
                            </ul>
                        </li>
                    </ul> -->
                </div>
            </div>
        </div>
    </header>
    <!-- Finish Header -->

    <!-- Start review-product -->
     <div class="review-product">
        <div class="container">
            <!-- Start Breadcrumb -->
            <section class="breadcrumb">
                <div class="container">
                    <div class="breadcrumb__content">
                    <div class="breadcrumb__home-content-icon">
                        <i class="fas fa-home breadcrumb__home-icon"></i>
                    </div>
                    <ul class="breadcrumb__list">
                        <li class="breadcrumb__item">
                        <a href="#" class="breadcrumb__link">
                            خانه
                            <i class="fas fa-angle-left breadcrumb__icon"></i>
                        </a>
                        </li>
                        <li class="breadcrumb__item">
                        <a href="#" class="breadcrumb__link">
                            آموزش برنامه نویسی فرانت اند
                            <i class="fas fa-angle-left breadcrumb__icon"></i>
                        </a>
                        </li>
                        <li class="breadcrumb__item">
                        <a href="#" class="breadcrumb__link">
                            دوره متخصص جاوا اسکریپت
                        </a>
                        </li>
                    </ul>
                    </div>
                </div>
            </section>     
            <!-- Finish Breadcrumb -->
        </div>  
    </div>   

    <section>
    <div class="product-details-container">
        <div class="product-image">
        <img id="product-image" src="" alt="Product Image">
        </div>
        <div class="product-info-detaile">
        <h1 id="product-title" class="product-title"></h1>
        <p id="product-description" class="product-description"></p>

        <h3 class="section-title">Features:</h3>
        <ul id="product-features" class="product-features"></ul>

        <h3 class="section-title">How to Use:</h3>
        <p id="product-usage" class="product-usage"></p>

        <h3 class="section-title">Ingredients:</h3>
        <p id="product-ingredients" class="product-ingredients"></p>

        <div class="price-section">
            <span id="product-price" class="price"></span>
        </div>

        <div class="quantity-section">
            <label for="quantity">Quantity:</label>
            <div class="quantity-controls">
            <button class="quantity-btn" id="decrease">-</button>
            <input type="number" id="quantity" name="quantity" value="1" readonly>
            <button class="quantity-btn" id="increase">+</button>
            </div>
        </div>

        <button id="add-to-cart" class="add-to-cart">Buy Now</button>
        </div>
    </div>
    </section>

    <section>
    <div class="product-intro">
        <div class="container">
        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs" id="productTab" role="tablist">
            <li class="nav-item" role="presentation">
            <button class="nav-link active" id="desc-tab" data-bs-toggle="tab" data-bs-target="#desc" type="button" role="tab" aria-controls="desc" aria-selected="true">Description</button>
            </li>
            <li class="nav-item" role="presentation">
            <button class="nav-link" id="ingredients-tab" data-bs-toggle="tab" data-bs-target="#ingredients" type="button" role="tab" aria-controls="ingredients" aria-selected="false">Ingredients</button>
            </li>
            <li class="nav-item" role="presentation">
            <button class="nav-link" id="storage-tab" data-bs-toggle="tab" data-bs-target="#storage" type="button" role="tab" aria-controls="storage" aria-selected="false">Storage Conditions</button>
            </li>
            <li class="nav-item" role="presentation">
            <button class="nav-link" id="nutrition-tab" data-bs-toggle="tab" data-bs-target="#nutrition" type="button" role="tab" aria-controls="nutrition" aria-selected="false">Nutritional Info</button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-3" id="productTabContent">

            <!-- Description Tab -->
            <div class="tab-pane fade show active" id="desc" role="tabpanel" aria-labelledby="desc-tab">
            <h3 id="desc-title"></h3>
            <p id="desc-text"></p>
            <p id="desc-extra"></p>
            </div>

            <!-- Ingredients Tab -->
            <div class="tab-pane fade" id="ingredients" role="tabpanel" aria-labelledby="ingredients-tab">
            <h3 class="section-title" id="ingredients-title">Ingredients</h3>
            <p id="ingredients-description" class="section-description"></p>
            <div id="ingredients-container" class="ingredients-container"></div>
            <p class="no-artificial" id="ingredients-no-artificial"></p>
            </div>

            <!-- Storage Conditions Tab -->
            <div class="tab-pane fade" id="storage" role="tabpanel" aria-labelledby="storage-tab">
            <h3 id="storage-title">Storage Conditions</h3>
            <p id="storage-text"></p>
            <ul id="storage-list"></ul>
            <p id="storage-note"></p>
            </div>

            <!-- Nutritional Info Tab -->
            <div class="tab-pane fade" id="nutrition" role="tabpanel" aria-labelledby="nutrition-tab">
            <div>
                <h3 id="nutrition-title">Nutritional Information (Per 100g)</h3>
                <table class="table table-bordered" id="nutrition-table">
                <thead>
                    <tr>
                    <th>Component</th>
                    <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Energy</td><td id="nutrition-energy"></td></tr>
                    <tr><td>Protein</td><td id="nutrition-protein"></td></tr>
                    <tr><td>Fat</td><td id="nutrition-fat"></td></tr>
                    <tr><td>Saturated Fat</td><td id="nutrition-saturated-fat"></td></tr>
                    <tr><td>Carbohydrates</td><td id="nutrition-carbohydrates"></td></tr>
                    <tr><td>Sugars</td><td id="nutrition-sugars"></td></tr>
                    <tr><td>Salt</td><td id="nutrition-salt"></td></tr>
                    <tr><td>Fiber</td><td id="nutrition-fiber"></td></tr>
                </tbody>
                </table>
            </div>
            <p id="nutrition-note"></p>
            </div>

        </div>
        </div>
    </div>
    </section>

    <section>
        <div class="related-products">
            <!-- Title -->
            <h2 class="text-lg-start mb-4">Related Products</h2>

            <!-- Container for dynamic related product cards -->
            <div id="related-products-container" class="row">
            <!-- Related product cards will be injected here dynamically -->
            </div>
        </div>
    </section>


    <!-- Finish  review-product -->

    <!-- Start Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-widgets">
            <div class="row">
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    درباره ما
                    </span>
                    <p class="footer-widgets__text">
                    وقتی تازه شروع به یادگیری برنامه نویسی کردم. یکی از مشکلاتی که در فرآیند یادگیری داشتم، کمبود آموزش های خوب با پشتیبانی قابل قبول بود که باعث شد اون موقع تصمیم بگیرم اگر روزی توانایی مالی و فنی قابل قبولی داشتم یک وب سایت برای حل این مشکل راه اندازی کنم! و خب امروز آکادمی آموزش برنامه نویسی سبزلرن به عنوان یک آکادمی خصوصی فعالیت میکنه و این به این معنی هست که هر مدرسی اجازه تدریس در اون رو نداره و باید از فیلترینگ های خاص آکادمی سبزلرن رد شه! این به این معنی هست که ما برامون فن بیان و نحوه تعامل مدرس با دانشجو بسیار مهمه! ما در آکادمی سبزلرن تضمین پشتیبانی خوب و با کیفیت رو به شما میدیم . چرا که مدرسین وب سایت سبزلرن حتی برای پشتیبانی دوره های رایگان شون هم هزینه دریافت میکنند و متعهد هستند که هوای کاربر های عزیز رو داشته باشند !
                    </p>
                </div>
                </div>
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    آخرین مطالب
                    </span>
                    <div class="footer-widgets__links">
                    <a href="#" class="footer-widgets__link">
                        نحوه نصب کتابخانه در پایتون | آموزش نصب کتابخانه پایتون
                    </a>
                    <a href="#" class="footer-widgets__link">
                        چگونه پایتون را آپدیت کنیم؟ | آموزش صفر تا صد آپدیت کردن پایتون      
                    </a>
                    <a href="#" class="footer-widgets__link">
                        آموزش نصب پایتون ( Python ) در در مک، ویندوز و لینوکس | گام به گام و تصویری
                    </a>
                    <a href="#" class="footer-widgets__link">
                        بهترین فریم ورک های فرانت اند | 16 فریم ورک Front end بررسی معایب و مزایا
                    </a>
                    <a href="#" class="footer-widgets__link">
                        معرفی بهترین سایت آموزش جاوا اسکریپت [ تجربه محور ] + آموزش رایگان
                    </a>
                    </div>
                </div>
                </div>
                <div class="col-4">
                <div class="footer-widgets__item">
                    <span class="footer-widgets__title">
                    دسترسی سریع
                    </span>
                    <div class="row">
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش HTML
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش CSS
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش جاوا اسکریپت
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش بوت استرپ
                            </a>
                        </div>
                        <div class="col-6">       
                        <a href="#" class="footer-widgets__link">
                            آموزش ریکت
                        </a>
                        </div>
                        <div class="col-6">
                            <a href="#" class="footer-widgets__link">
                                آموزش پایتون
                            </a>
                        </div>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div> 
        <div class="footer__copyright">
            <span class="footer__copyright-text">
                کلیه حقوق برای آکادمی آموزش برنامه نویسی سبز لرن محفوظ است.
            </span>
        </div>
    </footer>
    <!-- Finish Footer -->


    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/Bootstrap/bootstrap.bundle.min.js"></script>
    <script src="vendor/fontAwesome5/all.min.js"></script>
    <script src="vendor/SwiperSlider/swiper.js"></script>
    <script src="js/slider.js"></script>
  
    <!-- Bootstrap JS -->

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- <script type="module" src="js/index.js"></script> -->
 <script type="module" src="./js/menu.js"></script>
 <script type="module" src="./js/products.js"></script>
 <script type="module" src="./js/productDetails.js"></script>
 <script type="module" src="./js/related-products.js"></script>


<!-- Supabase -->

<!-- <script>
    const SUPABASE_URL = 'https://lgbgwpbpxtmltzrsbjnx.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxnYmd3cGJweHRtbHR6cnNiam54Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2NzUxNzQsImV4cCI6MjA2ODI1MTE3NH0.Em8mM1z9xvVVKSi5kDfSoq-_Qof-u5JM7hDdqec6XA0';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  
    // منو
    // اجرای اصلی بعد از بارگذاری
    document.addEventListener('DOMContentLoaded', fetchMenus);
  
    async function fetchMenus() {
      const { data: menus, error } = await supabase
        .from('menus')
        .select('*')
        .order('id', { ascending: true });
  
      if (error) {
        console.error('Error fetching menus:', error);
        return;
      }
  
      const menuTree = buildMenuTree(menus);
      const html = buildMenuHTML(menuTree);
      document.getElementById('navbar').innerHTML = html;
    }
  
    // تبدیل لیست به درخت منو
    function buildMenuTree(items, parentId = null) {
      return items
        .filter(item => item.parent_id === parentId)
        .map(item => ({
          ...item,
          children: buildMenuTree(items, item.id)
        }));
    }
  
    // تولید HTML از ساختار درختی
    function buildMenuHTML(tree) {
      let html = '';
      tree.forEach(item => {
        const hasChildren = item.children.length > 0;
        html += `
          <li class="main-header__item">
            ${item.url ? `<a href="${item.url}">${item.title}</a>` : `<span>${item.title}</span>`}
            ${hasChildren ? `<ul class="main-header__dropdown">${buildMenuHTML(item.children)}</ul>` : ''}
          </li>
        `;
      });
      return html;
    }
//////////////////////////////////////////////////////////////
// بارگزاری صفحه ارشیو


document.addEventListener('DOMContentLoaded', () => {
    fetchMenus(); // از قبل هست
    fetchProducts(); // این برای محصولات
  });

  async function fetchProducts() {
    const { data, error } = await supabase
    .from('products')
    .select(`
        id,
        name,
        description,
        price,
        stock,
        created_at,
        updated_at,
        category_id,
        image_url,
        category:category_id (
        id,
        name
        )
    `)
    .order('category_id', { ascending: true })  // مرتب سازی بر اساس دسته
    .order('id', { ascending: true });          // مرتب سازی محصولات داخل هر دسته بر اساس id



    if (error) {
      console.error('Error fetching products:', error);
      return;
    }

    renderProducts(data);
  }

function renderProducts(products) {
  const container = document.getElementById('products-container');
  container.innerHTML = '';

  const grouped = {};

  products.forEach(product => {
    const cat = product.category.name;
    if (!grouped[cat]) grouped[cat] = [];
    grouped[cat].push(product);
  });

  for (const categoryName in grouped) {
    const section = document.createElement('div');
    section.classList.add('product-boxes');

    section.innerHTML = `
      <h2 class="product-category">${categoryName}</h2>
      <div class="row">
        ${grouped[categoryName].map(prod => `
          <div class="col-3">
            <div class="product-boxes__box">
              <a href="#">
                <img src="${prod.image_url || 'images/products/placeholder.jpg'}" alt="${prod.name}" class="img-fluid improduct-box__img-main">
              </a>
              <div class="product-box__main">
                <div class="col-7 ps-2 product-box__detiles">
                  <a class="product-box__detiles-title">${prod.name}</a>
                  <p class="product-box__detiles-info">${prod.description}</p>
                  <p class="product-box__detiles-info">£${parseFloat(prod.price).toFixed(2)}/kg</p>
                </div>
              </div>
              <div class="product-box__footer"></div>
            </div>
          </div>
        `).join('')}
      </div>
    `;

    container.appendChild(section);
  }
}

//////////////////بارگزاری صفحه هر دسته 

// گرفتن slug از URL
const params = new URLSearchParams(window.location.search);
const categorySlug = params.get("slug");

if (!categorySlug) {
  document.getElementById("products-container").innerHTML = "<p>Please select a category.</p>";
} else {
  loadProductsByCategory(categorySlug);
}

async function loadProductsByCategory(slug) {
  const { data: category, error: catErr } = await supabase
    .from('categories')
    .select('id, name')
    .eq('slug', slug)
    .single();

  if (catErr || !category) {
    document.getElementById("products-container").innerHTML = "<p>Category not found.</p>";
    return;
  }

  // نمایش عنوان دسته
  document.getElementById("category-title").textContent = category.name;

  const { data: products, error: prodErr } = await supabase
    .from('products')
    .select('*')
    .eq('category_id', category.id);

  if (prodErr || !products) {
    document.getElementById("products-container").innerHTML = "<p>Error loading products.</p>";
    return;
  }

  const container = document.getElementById("products-container");
  container.innerHTML = ''; // پاک کردن محتوا قبل از نمایش محصولات

products.forEach(p => {
  const col = document.createElement("div");
  col.className = "col-3";

  const box = document.createElement("div");
  box.className = "product-boxes__box";

  box.innerHTML = `
    <a href="#">
      <img src="${p.image_url || 'https://via.placeholder.com/150'}"
           alt="${p.name}"
           class="img-fluid improduct-box__img-main" />
    </a>
    <div class="product-box__main">
      <div class="col-7 ps-2 product-box__detiles">
        <a class="product-box__detiles-title">${p.name}</a>
        <p class="product-box__detiles-info">${p.description || ''}</p>
        <p class="product-box__detiles-info">£${p.price}/kg</p>
        <span class="product-box__detiles-price">Guide price: £${(p.price * 0.45).toFixed(2)}</span>
      </div>
    </div>
    <div class="product-box__footer"></div>
  `;

  col.appendChild(box);
  container.appendChild(col);
});

}





</script> -->



<script>
//     document.getElementById('increase').addEventListener('click', function() {
//     let quantityInput = document.getElementById('quantity');
//     let currentValue = parseInt(quantityInput.value);
//     quantityInput.value = currentValue + 1;
// });

// document.getElementById('decrease').addEventListener('click', function() {
//     let quantityInput = document.getElementById('quantity');
//     let currentValue = parseInt(quantityInput.value);
//     if (currentValue > 1) {  // Prevent going below 1
//         quantityInput.value = currentValue - 1;
//     }
// });

</script>
</body>
</html>